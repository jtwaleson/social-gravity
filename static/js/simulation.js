// Generated by CoffeeScript 1.3.3
(function() {
  var Simulation;

  Simulation = (function() {

    function Simulation() {
      var _this = this;
      this.gravity_worker = new Worker('js/gravity_worker.js');
      this.gravity_worker.onmessage = function(event) {
        var d, friend, _i, _len, _ref, _results;
        _ref = event.data;
        _results = [];
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          d = _ref[_i];
          friend = friends[d.id];
          friend.setX(d.x);
          _results.push(friend.setY(d.y));
        }
        return _results;
      };
    }

    Simulation.prototype.register = function(friend) {
      return this.gravity_worker.postMessage({
        new_friend: friend.id,
        x: friend.x,
        y: friend.y,
        friends: friend.friends
      });
    };

    Simulation.prototype.start = function() {
      return this.gravity_worker.postMessage({
        start: true
      });
    };

    Simulation.prototype.stop = function() {
      return this.gravity_worker.postMessage({
        stop: true
      });
    };

    return Simulation;

  })();

  window.simulation = new Simulation;

  $(function() {
    var btn, li;
    btn = $("<button>").text("s").click(function(event) {
      if ($(this).is('.started')) {
        simulation.stop();
      } else {
        simulation.start();
      }
      return $(this).toggleClass('started');
    });
    li = $("<li>");
    li.append(btn);
    return li.appendTo($("#menu"));
  });

}).call(this);
